<!DOCTYPE html>
<html lang="en">
  
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
    rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/reset.css" />
  <link rel="stylesheet" href="../css/index.css" />
  <link rel="stylesheet" href="../css/blog.css" />
  <title>NodeSecure - Blog</title>
</head>

<body>
  <canvas id="network-bg"></canvas>

  <header class="blogHeader">
    <div class="header-background"></div>
    <div class="header-content centered-content">
      <img src="https://avatars.githubusercontent.com/u/85318671?s=200&v=4" alt="NodeSecure Logo"
        style="width:80px;height:80px;border-radius:20px;background:#fff2;box-shadow:0 2px 8px #0002;margin-bottom:1.2rem;">
      <h1>
        NodeSecure Blog
      </h1>
      <p class="subtitle">
        Building a safer Node.js and JavaScript ecosystem
      </p>
      <p class="description">We are a community of developers building free open source tools to secure the Node.js & JavaScript ecosystem. Our area of expertise is <b>SCA</b> (Software Composition Analysis).</p>
      <div class="header-buttons">
        <a href="https://github.com/NodeSecure" target="_blank" title="NodeSecure on GitHub" class="view-on-github">
          <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/github.svg" alt="GitHub"
            style="width:28px;height:28px;filter:invert(1) brightness(2);">
          <span>View on GitHub</span>
        </a>
        <a href="https://discord.gg/4Wn8rjAtB4" target="_blank" title="Join our Discord" class="view-on-discord">
          <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/discord.svg" alt="Discord"
            style="width:28px;height:28px;filter:invert(1) brightness(2);">
          <span>Join Discord</span>
        </a>
        <a href="./index.html" title="Visit our blog" class="view-on-discord">
          <img width="64" height="64" src="https://img.icons8.com/glyph-neue/64/circled-left-2.png"   style="width:28px;height:28px;filter:invert(1) brightness(2);" alt="Back to blog"/>
          <span>Back to blog</span>
        </a>
      </div>
    </div>
  </header>
  <main>
    
    <article>
      <div class="article-content">
        <h1 class="article-title">NodeSecure Vuln-era</h1>
        <p>Hello 👋,</p>
<p>Back for a little article about the rebranding of one of the NodeSecure tools: <a href="https://github.com/NodeSecure/vuln">Vulnera</a> (previously <em>vuln</em>, the <strong>vuln-era</strong> has begun!).</p>
<p>An opportunity for me to also write about this wonderful project that was born with the redesign of the back-end less than a year ago ⌚. If you don't remember I wrote an article:</p>
<p>{% link <a href="https://dev.to/fraxken/announcing-new-node-secure-back-end-1dp9">https://dev.to/fraxken/announcing-new-node-secure-back-end-1dp9</a> %}</p>
<p>Don't wait and dive in 🌊 with me to discover this tool 💃.</p>
<h2>What is Vulnera ? 👀</h2>
<p>Vulnera is a package that allows you to <strong>programmatically</strong> fetch your Node.js project vulnerabilities from <strong>multiple sources or strategies</strong>:</p>
<ul>
<li>NPM Audit (<a href="https://github.com/advisories">Github Advisory Database</a>)</li>
<li><a href="https://ossindex.sonatype.org/">Sonatype OSS Index</a></li>
<li>deprecated <a href="https://github.com/nodejs/security-wg/tree/main/vuln">Node.js Security WG Database</a></li>
<li>Snyk</li>
</ul>
<blockquote>
<p>📢 Feel free to push new sources (we have <a href="https://github.com/NodeSecure/vuln/blob/main/docs/adding_new_strategy.md">a guide</a> on how to add/contribute one).</p>
</blockquote>
<p>The code was originally designed for vulnerability management within the <a href="https://github.com/NodeSecure/scanner">Scanner</a>. Yet, its API is <strong>evolving</strong> with the objective of making it a <strong>full-fledged project</strong>.</p>
<pre><code class="language-js">import * as vulnera from "@nodesecure/vulnera";

const def = await vulnera.setStrategy(
  vulnera.strategies.NPM_AUDIT
);

const vulnerabilities = await def.getVulnerabilities(process.cwd(), {
  useStandardFormat: true
});
console.log(vulnerabilities);
</code></pre>
<h3>Standard vulnerability format 👯</h3>
<p>We have created a standard format to reconcile the different sources.</p>
<pre><code class="language-ts">export interface StandardVulnerability {
  /** Unique identifier for the vulnerability **/
  id?: string;
  /** Vulnerability origin, either Snyk, NPM or NodeSWG **/
  origin: Origin;
  /** Package associated with the vulnerability **/
  package: string;
  /** Vulnerability title **/
  title: string;
  /** Vulnerability description **/
  description?: string;
  /** Vulnerability link references on origin's website **/
  url?: string;
  /** Vulnerability severity levels given the strategy **/
  severity?: Severity;
  /** Common Vulnerabilities and Exposures dictionary */
  cves?: string[];
  /** Common Vulnerability Scoring System (CVSS) **/
  cvssVector?: string;
  /** CVSS Score **/
  cvssScore?: number;
  /** The range of vulnerable versions */
  vulnerableRanges: string[];
  /** The set of versions that are vulnerable **/
  vulnerableVersions: string[];
  /** The set of versions that are patched **/
  patchedVersions?: string;
  /** Overview of available patches **/
  patches?: Patch[];
}
</code></pre>
<p>You can always use the original formats of each source of course 😊. We have implemented and exposed <strong>TypeScript interfaces</strong> for each of them.</p>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/0eqb67gqp772iawr10gp.png" alt="NodeSecure types"></p>
<h2>Usage in Scanner 🔬</h2>
<p>On the scanner we have all the necessary information because we go through the dependency tree 🎄. At <a href="https://github.com/NodeSecure/scanner/blob/master/src/depWalker.js#L297">the end of the process</a>, we recover all vulnerabilities by iterating <strong>spec</strong> by <strong>spec</strong> within the <strong>hydratePayloadDependencies</strong> strategy method.</p>
<pre><code class="language-js">const {
  hydratePayloadDependencies,
  strategy
} = await vulnera.setStrategy(
  userStrategyName // SNYK for example
);
await hydratePayloadDependencies(dependencies, {
  useStandardFormat: true,
  path: location
});

payload.vulnerabilityStrategy = strategy;
</code></pre>
<p>The following diagram explains the overall behavior and interactions between the Scanner and Vulnera.
<img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/6x76ry38w7qcitdulayh.png" alt="NodeSecure"></p>
<p>If you want to learn more about the Payload you can check the TypeScript interface <a href="https://github.com/NodeSecure/scanner/blob/master/types/scanner.d.ts#L132">here</a>.</p>
<h2>What's next ? 🚀</h2>
<p>Some sources are more difficult to exploit than others (for NPM we use <a href="https://www.npmjs.com/package/@npmcli/arborist">Arborist</a> which simplifies our lives).</p>
<pre><code class="language-js">const { vulnerabilities } = (await arborist.audit()).toJSON();
</code></pre>
<p>However, we have to think and create mechanics to exploit sources like Sonatype 😨. This is required for API like <code>getVulnerabilities()</code>.</p>
<p>Among the major subjects and <strong>ideas</strong> we are working on:</p>
<ul>
<li>Create a <strong>private</strong> database to benchmark the sources between them (see <a href="https://github.com/NodeSecure/vulnera/issues/29">#29</a>).</li>
<li>Merging multiple sources in one (see <a href="https://github.com/NodeSecure/vulnera/issues/25">#25</a>).</li>
<li>Fetch vulnerabilities of a given remote package (with support for private registry like <a href="https://verdaccio.org/">verdaccio</a>). At the moment we only support the analysis of a local manifest or a payload of the scanner.</li>
</ul>
<h2>Credits 🙇</h2>
<p>This project owes much to our core collaborator <a href="https://www.linkedin.com/in/antoine-coulon-b29934153/">Antoine COULON</a> who invested a lot of energy to improve it 💪.</p>
<blockquote>
<p><strong>Fun fact:</strong> <a href="https://github.com/NodeSecure/cli/commit/236c7333720b14878b5f620f3a814c045a375a45">its first contribution</a> 🐤 on NodeSecure was also on the old version of the code Scanner that managed vulnerabilities.</p>
</blockquote>
<p>But I don't forget individual contributions 👏</p>
<ul>
<li><a href="https://www.linkedin.com/in/mathieu-kahlaoui-0887a1158/">Mathieu Kahlaoui</a> for adding <a href="https://github.com/NodeSecure/vuln/pull/33">the getVulnerabilities() API</a></li>
<li><a href="https://www.linkedin.com/in/oleh-sych-41245116a/">Oleh Sych</a> for adding <a href="https://github.com/NodeSecure/vuln/pull/11">Snyk strategy</a></li>
<li>Medhi for his work on the logo</li>
</ul>
<hr>
<p>Thanks 🙏 for reading me and see you soon for another article!</p>

      </div>
    </article>
  </main>

  <script type="module" src="../src/particules.js"></script>
</body>

</html>